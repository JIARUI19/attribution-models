# attribution-models

## 风险因子归因：
- 组合权益资产收益=风格因子贡献+行业因子贡献+特质因子贡献
- 风格因子贡献(风格因子-火富牛):
  
  ![image](https://github.com/user-attachments/assets/927949e9-5fd1-4ee6-a09a-04e02dab912b)

- 行业因子贡献(行业占比/行业收益率):
行业因子 = 组合在行业上的占比 x 该行业指数收益率
- 特质因子贡献 = 模型的残差项 = 组合权益资产收益-风格因子-行业因子

## Brinson归因：
所需因子及其计算方式:

计算基金权益组合归一化（剔除仓位影响，权益组合按满仓计算）之后的历史日频净值。

- TR(行业收益率/行业权重/基金权益持仓中行业收益率及权重-年报或火富牛):

$$
\text{TR(总超额收益)} = \sum_{i=1}^{N} \left( \text{基金权益持仓中行业i配置比例} \times \text{行业i组合收益} - \text{基准中行业i配置比例} \times \text{基准行业i组合收益} \right)
$$

- AR(行业收益率/行业权重/权益持仓中行业权重-年报或火富牛): 

$$
\text{AR(行业配置收益)} = \sum_{i=1}^{N} \left( \text{基金权益持仓中行业i配置比例} - \text{基准中行业i配置比例} \right) \times \text{行业i基准组合收益}
$$

- SR(行业收益率/行业权重/权益持仓行业收益率-年报或火富牛):

$$
\text{SR(证券选择收益)} = \sum_{i=1}^{N} \left( \text{基金权益持仓行业 𝒊 组合收益} - \text{基准行业i组合收益} \right) \times \text{基准中行业 𝒊 配置比例}
$$

- IR(交互收益) = TR-AR-SR

## Campisi归因：

所需因子及其计算方式：

一、单期Campisi业绩归因

不基于重仓债券，利用基金的半年报和年报对整体债券持仓计算。

- 收入效应（基于基金半年报和年报的利息收入/债券市值）： 

$$
\text{收入效应} = \frac{\text{债券利息收入}}{\left(\text{期初债券市值} + \text{期末债券市值}\right) / 2}
$$

- 国债效应（基于基金半年报和年报中披露的"利率风险的敏感性分析"数据进行计算久期）：

$$
\text{国债效应} = \text{久期} \times \left(\text{期末国债收益率} - \text{期初国债收益率}\right)
$$

- 利差效应(信用债评级指数到期收益率/国债收益率):

$$
\text{利差效应} = \text{久期} \times \left(\text{期末利差} - \text{期初利差}\right)
$$

其中利差计算为与持仓中的信用债久期及评级相匹配的信用债指数到期收益率减去对应期限的国债收益率，基于基金季度财报计算，然后累乘生成半年度值。

- 券种选择效应（基于基金半年报和年报的债券投资收益/公允价值变动损益/债券市值）：

$$
\text{券种选择效应} = \text{资本利得效应} - \text{国债效应} - \text{利差效应}
$$

其中资本利得效应：

$$
\text{资本利得效应} = \frac{\text{债券投资收益} + \text{债券公允价值变动损益}}{\left(\text{期初债券市值} + \text{期末债券市值}\right) / 2}
$$

- 债券投资拟合总收益:

$$
\text{债券投资拟合总收益} = \text{收入效应} + \text{资本利得效应}
$$

二、多期Campisi业绩归因

单期归因是以半年为一期，多期归因是将单期归因结果的进一步整合，生成一段时间区间（1年、3年等）。r为区间收益率。

- 单期调整系数kt：
  
$$ k_t = \frac{\ln(1 + r_t)}{r_t} $$

- 多期调整系数k：

$$ k = \frac{\ln(1 + r)}{r} $$

- 各期调整系数mt：
  
$$ m_t = \frac{k_t}{k} $$

多期归因效应 = 

$$ \text{attr} = \sum_t m_t \times \text{attr}_t $$ 

## 大类资产归因：

- 基金净值回报率=大类资产配置贡献+证券选择贡献
- 大类资产配置贡献(持仓中各大类资产权重-？/各指数区间回报率-火富牛)：

$$
\text{大类资产配置贡献} = \sum_{i=1}^{N}\text{期初资产i配置比例} \times \text{该资产对应的代表性指数区间回报率}
$$

- 证券选择贡献(基金回报率-火富牛)：

$$ 
\text{证券选择贡献} = \text{基金净值回报率} - \text{大类资产配置贡献}
$$

多期计算方法和Campisi相同。

## 债基Campisi归因：
- 久期因子(Beta因子)

- 期限结构因子(风格因子)：

- 信用利差因子(中债企业债AAA指数/中债国开行债券指数)：
  
构建该因子时也进行久期中性处理，通过买入中债企业债AAA指数并卖出中债国开行债券指数，并根据这两个指数的久期调整各期权重。

- 评级利差因子(中债高收益企业债指数/中债企业债AAA指数)：

通过买入中债高收益企业债指数并卖出中债企业债AAA指数，并根据两个指数的久期调整其比例以保证久期中性。
  
- 可转债因子(中债转债收益率/中债国债总财富指数收益率)：
可转债因子 = 中债转债收益率-中债国债总财富指数收益率


